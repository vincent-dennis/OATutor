FROM node:22-alpine

WORKDIR /app

# Copy dependency manifests first (enables caching)
COPY package*.json ./

# Install dependencies (includes devDependencies like nodemon, concurrently)
RUN npm ci

# Copy the rest of the project (source code, server/, common/, etc.)
COPY . .

# React dev server uses 3001
EXPOSE 3001

# Backend server uses 4000
EXPOSE 4000

# Run the same command you run locally in development
CMD ["npm", "run", "dev"]
